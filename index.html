<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Layanan Digital Kelurahan Serengan</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

<style>
:root{
  --p:#1f7aec;
  --s:#20c997;
  --bg:#f4fbfa;
}
body{font-family:'Segoe UI',sans-serif;background:var(--bg);}
.navbar{background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.05)}
.hero{margin-top:56px;}
.hero img{height:45vh;object-fit:cover;}
.hero-overlay{
  position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(31,122,236,.85),rgba(32,201,151,.85));
}
.hero-content{
  position:absolute;inset:0;
  display:flex;align-items:center;justify-content:center;
  text-align:center;color:#fff;z-index:2;
}
.service-card{
  background:#fff;border-radius:18px;padding:24px;
  text-align:center;cursor:pointer;transition:.3s;
  box-shadow:0 8px 20px rgba(0,0,0,.08);
}
.service-card:hover{
  transform:translateY(-6px);
  box-shadow:0 16px 32px rgba(0,0,0,.15);
}
.icon{
  width:60px;height:60px;
  background:linear-gradient(135deg,var(--p),var(--s));
  color:#fff;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:28px;margin:auto;margin-bottom:10px;
}

/* === LOADER === */
.loader-wrap{
  position:absolute;inset:0;background:#fff;
  display:flex;align-items:center;justify-content:center;z-index:10;
}
.spinner{
  width:48px;height:48px;border:5px solid #ddd;
  border-top:5px solid var(--p);border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg);}}

/* === STEPPER === */
.stepper{display:flex;gap:12px;flex-wrap:wrap}
.step{
  flex:1;background:#f3f6fb;padding:12px;border-radius:12px;
  text-align:center;animation:fadeUp .4s ease;
}
.step span{
  display:block;width:32px;height:32px;margin:auto;
  background:var(--p);color:#fff;border-radius:50%;
  line-height:32px;margin-bottom:6px;
}
@keyframes fadeUp{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:none}
}

/* === FULLSCREEN MOBILE === */
@media(max-width:768px){
  #formModal .modal-dialog{max-width:100%;height:100%;margin:0;}
  #formModal .modal-content{height:100vh;border-radius:0;}
  #formModal iframe{height:92vh!important;}
}
</style>
</head>

<body>

<nav class="navbar fixed-top px-3">
  <strong>Kelurahan Serengan â€“ Kota Surakarta</strong>
</nav>

<section class="container my-5 pt-5" id="layanan">
<div class="row g-4">

<!-- SKUM -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Umum"
    data-syarat="<li>KTP-el</li><li>Kartu Keluarga</li><li>Pengantar RT/RW</li>"
    data-alur="Pengajuan|Verifikasi|Terbit"
    data-link="https://script.google.com/macros/s/AKfycbxpNPhzcQY3_BQSQW3vSZsOAjw04oZpD3uzXBONYz2mLMl_DCkqEQkHQRTj0W8cU3VHjg/exec">
    <div class="icon">ğŸ“„</div>
    <h6>Surat Keterangan Umum</h6>
  </div>
</div>

<!-- DOMISILI -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Domisili"
    data-syarat="<li>KTP-el</li><li>Kartu Keluarga</li><li>Pengantar RT/RW</li>"
    data-alur="Pengajuan|Validasi|Cetak"
    data-link="LINK_DOMISILI">
    <div class="icon">ğŸ </div>
    <h6>Surat Domisili</h6>
  </div>
</div>

<!-- USAHA -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Usaha"
    data-syarat="<li>KTP-el</li><li>Kartu Keluarga</li><li>Foto Usaha</li>"
    data-alur="Pengajuan|Survey|Terbit"
    data-link="LINK_USAHA">
    <div class="icon">ğŸª</div>
    <h6>Surat Usaha</h6>
  </div>
</div>

<!-- TIDAK MAMPU -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Tidak Mampu"
    data-syarat="<li>KTP-el</li><li>Kartu Keluarga</li><li>Pengantar RT/RW</li>"
    data-alur="Pengajuan|Verifikasi|Terbit"
    data-link="LINK_SKTM">
    <div class="icon">ğŸ¤</div>
    <h6>SK Tidak Mampu</h6>
  </div>
</div>

<!-- PINDAH -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Pindah"
    data-syarat="<li>KTP-el</li><li>Kartu Keluarga</li><li>Alamat Tujuan</li>"
    data-alur="Pengajuan|Validasi|Terbit"
    data-link="LINK_PINDAH">
    <div class="icon">ğŸšš</div>
    <h6>Surat Pindah</h6>
  </div>
</div>

<!-- DATANG -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Datang"
    data-syarat="<li>KTP-el</li><li>KK Asal</li><li>Alamat Tujuan</li>"
    data-alur="Pengajuan|Validasi|Cetak"
    data-link="LINK_DATANG">
    <div class="icon">ğŸ“</div>
    <h6>Surat Datang</h6>
  </div>
</div>

<!-- KELAHIRAN -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Kelahiran"
    data-syarat="<li>KK</li><li>KTP Orang Tua</li><li>Surat RS/Bidan</li>"
    data-alur="Pengajuan|Verifikasi|Terbit"
    data-link="LINK_KELAHIRAN">
    <div class="icon">ğŸ‘¶</div>
    <h6>Keterangan Kelahiran</h6>
  </div>
</div>

<!-- KEMATIAN -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Keterangan Kematian"
    data-syarat="<li>KK</li><li>KTP Pelapor</li><li>Surat RS</li>"
    data-alur="Pengajuan|Validasi|Terbit"
    data-link="LINK_KEMATIAN">
    <div class="icon">ğŸ•Šï¸</div>
    <h6>Keterangan Kematian</h6>
  </div>
</div>

<!-- IZIN KERAMAIAN -->
<div class="col-6 col-md-4">
  <div class="service-card"
    data-bs-toggle="modal"
    data-bs-target="#layananModal"
    data-title="Surat Izin Keramaian"
    data-syarat="<li>KTP-el</li><li>Waktu & Lokasi</li><li>Penanggung Jawab</li>"
    data-alur="Pengajuan|Koordinasi|Terbit"
    data-link="LINK_KERAMAIAN">
    <div class="icon">ğŸ‰</div>
    <h6>Izin Keramaian</h6>
  </div>
</div>

</div>


</div>
</section>

<div class="modal fade" id="layananModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modalTitle"></h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <h6>Syarat</h6>
        <ul id="modalSyarat"></ul>

        <h6 class="mt-3">Alur Pelayanan</h6>
        <div id="modalAlur" class="stepper"></div>

        <div class="form-check mt-3">
          <input class="form-check-input" type="checkbox" id="chkAgree">
          <label class="form-check-label">
            Saya sudah menyiapkan persyaratan
          </label>
        </div>

        <div class="text-end mt-3">
          <button id="btnOpenForm" class="btn btn-primary">
            Isi Formulir
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="formModal" tabindex="-1">
  <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="formTitle"></h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body p-0 position-relative">
        <div class="loader-wrap" id="frameLoader">
          <div class="spinner"></div>
        </div>

        <iframe id="layananFrame"
          src=""
          style="width:100%;height:80vh;border:0"
          loading="lazy"></iframe>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
const frame = document.getElementById('layananFrame');
const loader = document.getElementById('frameLoader');

document.querySelectorAll('.service-card').forEach(card => {
  card.addEventListener('click', function () {

    const title = this.dataset.title;
    const syarat = this.dataset.syarat;
    const alur = this.dataset.alur;
    const link = this.dataset.link;

    modalTitle.innerText = title;
    modalSyarat.innerHTML = syarat;

    let steps = '';
    alur.split('|').forEach((item,i)=>{
      steps += `
        <div class="step" style="animation-delay:${i*0.1}s">
          <span>${i+1}</span>${item}
        </div>`;
    });
    modalAlur.innerHTML = steps;

    chkAgree.checked = false;

    btnOpenForm.onclick = function(){
      if(!chkAgree.checked){
        alert('Silakan centang persetujuan terlebih dahulu.');
        return;
      }

      loader.style.display = 'flex';
      frame.src = link;
      formTitle.innerText = title;

      bootstrap.Modal.getOrCreateInstance(layananModal).hide();
      bootstrap.Modal.getOrCreateInstance(formModal).show();
    }
  });
});

frame.onload = () => loader.style.display = 'none';

formModal.addEventListener('hidden.bs.modal',()=>{
  frame.src = '';
});
</script>

</body>
</html>

